<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formateur de numéro de téléphone</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <h1 style="color: #075e54;">
            <span style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="80" height="80" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" color="currentColor"><path d="M21 20c-.643-1.287-2-2.976-2-4.472c0-1.699.367-3.794-.422-5.373c-.334-.666-.578-1.341-.578-2.1V4.43a.43.43 0 0 0-.429-.43A2.57 2.57 0 0 0 15 6.571M8 18l3.635 2.272c.24.15.446.35.604.586L13 22"/><path d="M5.027 15c.055 1.097.218 1.78.705 2.268C6.464 18 7.642 18 10 18s3.535 0 4.268-.732C15 16.535 15 15.357 15 13V7c0-2.357 0-3.536-.732-4.268C13.535 2 12.357 2 10 2s-3.536 0-4.268.732c-.487.487-.65 1.171-.705 2.268"/><path d="M4.25 7.5h1.5a1.25 1.25 0 1 0 0-2.5h-1.5a1.25 1.25 0 1 0 0 2.5m0 0h2.5a1.25 1.25 0 1 1 0 2.5h-2.5m0-2.5a1.25 1.25 0 1 0 0 2.5m0 0h1.5a1.25 1.25 0 1 1 0 2.5h-1.5m0-2.5a1.25 1.25 0 1 0 0 2.5m0 0h1a1.25 1.25 0 1 1 0 2.5h-1a1.25 1.25 0 1 1 0-2.5M10 15h.009"/></g></svg> 
                Formattage de Numéro Sénégalais et Génération de CSV  
            </span>
        </h1>
        <h3 style="text-align: center; color: #128c7e;">Compatible avec  pour l'envoi de messages WhatsApp en masse </h3>
        <h3 style="text-align: center; color: #128c7e; display: flex; align-items: center; justify-content: center; gap: 10px;">
            <img src="img/logo1.png" width="180" alt="sender" style="vertical-align: middle;" />
            <img src="img/logo2.png" width="180" alt="wawasen" style="vertical-align: middle;" />
            <img src="img/logo3.png" width="180"  alt="whatsapp" style="vertical-align: middle;" />
        </h3>
        <p style="text-align: center; color: #666;">Ajoutez les signes « + » manquants ou l'indicatif « +221 »  aux numéros de téléphone dans votre fichier CSV</p>
        
        <div class="upload-section">
            <h3>Télécharger un fichier CSV ou coller du contenu</h3>
            <div class="file-input">
                <label for="csvFile" class="file-label">
                    <span style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" color="currentColor"><path d="M11.57 21h-1.063c-4.01 0-6.015 0-7.261-1.546S2 15.42 2 10.444V7.22c0-1.917 0-2.876.324-3.595a2.94 2.94 0 0 1 .984-1.223C3.888 2 4.661 2 6.206 2c.99 0 1.485 0 1.918.202c.99.46 1.398 1.575 1.844 2.683l.539 1.337m-3.503 0h8.545c1.792 0 2.688 0 3.332.534c.278.23.518.528.704.874c.29.538.384 1.219.415 2.287"/><path d="M4.596 12.576c.43-1.15.647-1.724 1.067-2.085c.68-.582 1.657-.485 2.494-.485h9.095c2.477 0 3.716 0 4.334.797c1.06 1.368-.191 3.587-.695 4.93c-.904 2.408-1.356 3.612-2.256 4.346c-1.371 1.119-3.366.904-5.021.904H9.937c-3.543 0-5.314 0-6.236-1.096c-1.7-2.025.13-5.274.895-7.312"/></g></svg> 
                    Choisissez un fichier CSV
                    </span>
                    
                </label>
                <input type="file" id="csvFile" accept=".csv" onchange="handleFileUpload(event)">
            </div>
            <p>OU</p>
            <div class="textarea-section">
                <textarea class="csv-textarea" id="csvContent" placeholder="Paste your CSV content here (with semicolon ; as delimiter)..."></textarea>
            </div>
            <button class="process-btn" onclick="processPhoneNumbers()"><span style="display: flex; align-items: center; justify-content: center; gap: 6px;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" color="currentColor"><path d="m21.318 7.141l-.494-.856c-.373-.648-.56-.972-.878-1.101c-.317-.13-.676-.027-1.395.176l-1.22.344c-.459.106-.94.046-1.358-.17l-.337-.194a2 2 0 0 1-.788-.967l-.334-.998c-.22-.66-.33-.99-.591-1.178c-.261-.19-.609-.19-1.303-.19h-1.115c-.694 0-1.041 0-1.303.19c-.261.188-.37.518-.59 1.178l-.334.998a2 2 0 0 1-.789.967l-.337.195c-.418.215-.9.275-1.358.17l-1.22-.345c-.719-.203-1.078-.305-1.395-.176c-.318.129-.505.453-.878 1.1l-.493.857c-.35.608-.525.911-.491 1.234c.034.324.268.584.736 1.105l1.031 1.153c.252.319.431.875.431 1.375s-.179 1.056-.43 1.375l-1.032 1.152c-.468.521-.702.782-.736 1.105s.14.627.49 1.234l.494.857c.373.647.56.971.878 1.1s.676.028 1.395-.176l1.22-.344a2 2 0 0 1 1.359.17l.336.194c.36.23.636.57.788.968l.334.997c.22.66.33.99.591 1.18c.262.188.609.188 1.303.188h1.115c.694 0 1.042 0 1.303-.189s.371-.519.59-1.179l.335-.997c.152-.399.428-.738.788-.968l.336-.194c.42-.215.9-.276 1.36-.17l1.22.344c.718.204 1.077.306 1.394.177c.318-.13.505-.454.878-1.101l.493-.857c.35-.607.525-.91.491-1.234s-.268-.584-.736-1.105l-1.031-1.152c-.252-.32-.431-.875-.431-1.375s.179-1.056.43-1.375l1.032-1.153c.468-.52.702-.781.736-1.105s-.14-.626-.49-1.234"/><path d="M15.52 12a3.5 3.5 0 1 1-7 0a3.5 3.5 0 0 1 7 0"/></g></svg>Traiter les numéros de téléphone</span> </button>
        </div>

        <div class="status" id="status" style="display: none;"></div>
        
        <div class="results-section" id="resultsSection">
            <div class="stats" id="stats">
                <div class="stat-box">
                    <div class="stat-number" id="totalCount">0</div>
                    <div class="stat-label">Chiffres totaux</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="correctedCount">0</div>
                    <div class="stat-label">Chiffres corrigés</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number" id="alreadyCorrectCount">0</div>
                    <div class="stat-label">Déjà correct</div>
                </div>
            </div>

            <div class="controls" id="controls">
                <button class="download-btn" onclick="downloadCorrectedCSV()">
                    <span style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 20h12m-6-4V4m4 8s-2.946 4-4 4s-4-4-4-4" color="currentColor"/></svg>
                         Télécharger le CSV corrigé
                    </span>
                 
                </button>
                <button class="download-btn" onclick="downloadCorrectedList()">
                    <span style="display: flex; align-items: center; justify-content: center; gap: 6px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M6 20h12m-6-4V4m4 8s-2.946 4-4 4s-4-4-4-4" color="currentColor"/></svg>
                        Télécharger les corrections uniquement
                    </span>
                </button>
            </div>

            <div class="preview" id="preview">
                <h4 style="text-align: center; color: #666;">Aperçu des modifications (50 premières lignes)</h4>
                <table id="previewTable">
                    <thead>
                        <tr>
                            <th>Nom</th>
                            <th>Original N° Téléphone</th>
                            <th>N° Téléphone Corrigé</th>
                            <th>Statut</th>
                        </tr>
                    </thead>
                    <tbody id="previewBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="js/script.js"></script>
</body>
</html>